syntax = "proto3";

package abi;

// data sent to the server for login
message LoginRequest{
    // user's unqiue id
    string username = 1;
    string password = 2;
}

// token generated by the server
message Token{
    // token data
    string data = 1;
}

message NewChatMessage{
    // unique room name (can be username, a group name, etc.)
    string room = 1;
    // chat content
    string content = 2;
}

// an empty send messages response
message SendMessageResponse{}

// an empty get messages request
message GetMessageRequest{}

// chat message
message ChatMessage{
    // who sends this message
    string sender = 1;
    // the room this message is sent to
    string room = 2;
    // content of the message
    string content = 3;
    // timestamp
    int64 timestamp = 4;
}

service ChatService{
    // to login user and get tokens
    rpc Login(LoginRequest) returns (Token){}
    // to send message to a chatting room
    rpc SendMessage(NewChatMessage) returns (SendMessageResponse){}
    // to subscribe and get all messages
    rpc GetMesssages(GetMessageRequest) returns (stream ChatMessage){}
}
